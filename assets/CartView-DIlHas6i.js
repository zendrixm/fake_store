import{u as O}from"./CartStore-DIyghlpD.js";import{d as R,f as T,g as C,c as k,a as c,v as q,i as t,t as d,j as l,k as r,o as g,q as _,u as D,J as E,s as j,F as G,x as K,E as W,m as X,_ as Y,b as Z,h as ee}from"./index-DxJcn1B2.js";const te={class:"cart-wrapper"},le={class:"txtDarkBlue"},ae={key:0,class:"table-scroll-wrapper"},ne=["src","alt"],oe={class:"card-header"},se=["src"],ue={class:"card-body"},ce={key:1,class:"cart-total"},de={class:"check-all-wrapper"},ie={class:"total-wrapper"},re={class:"flex gap-5"},_e=R({__name:"AddToCartSection",props:{products:{type:Object}},emits:["handleQuantityChange","removeProduct","selectionChange"],setup(F,{emit:y}){const m=X(),V=F,p=y,o=T([]),i=C(()=>{var e;return(e=V.products)==null?void 0:e.products}),x=C(()=>i.value.filter(e=>o.value.includes(e.id)).reduce((e,a)=>e+a.price*a.quantity,0).toFixed(2)),w=C(()=>{var e;return o.value.length===((e=i.value)==null?void 0:e.length)}),u=C(()=>o.value.length>0&&!w.value),b=e=>{o.value=e.map(a=>a.id),p("selectionChange",o.value)},Q=(e,a)=>{console.log("handleQuantityChange",e,a),p("handleQuantityChange",{value:e,product:a})},B=e=>{p("removeProduct",e)},z=e=>{var a;o.value=e?((a=i.value)==null?void 0:a.map(h=>h.id))??[]:[],p("selectionChange",o.value)},L=async()=>{if(o.value.length===0){W.warning("Please select at least one product to checkout.");return}m.push("/confirmation")};return(e,a)=>{var N;const h=r("el-table-column"),I=r("el-input-number"),U=r("el-icon"),S=r("el-button"),M=r("el-table"),A=r("el-checkbox"),v=r("el-text"),P=r("el-row"),H=r("el-checkbox-group"),J=r("el-col");return g(),k("div",te,[c("h2",le,d(e.$t("shoppingCart")),1),a[4]||(a[4]=c("div",{class:"v-spacer-15"},null,-1)),(N=i.value)!=null&&N.length?(g(),k("div",ae,[t(M,{class:"cart-table hidden-xs",data:i.value,stripe:"",onSelectionChange:b,"row-key":"id"},{default:l(()=>[t(h,{type:"selection",width:"55"}),t(h,{label:"",width:"120"},{default:l(({row:n})=>[c("img",{src:n.thumbnail,alt:n.title,width:"70",height:"80"},null,8,ne)]),_:1}),t(h,{prop:"title",label:e.$t("product"),width:"280"},null,8,["label"]),t(h,{prop:"price",label:e.$t("unitPrice"),width:"170"},{default:l(({row:n})=>[_(" $"+d(n.price.toFixed(2)),1)]),_:1},8,["label"]),t(h,{label:e.$t("quantity"),width:"220"},{default:l(({row:n})=>[t(I,{modelValue:n.quantity,"onUpdate:modelValue":f=>n.quantity=f,min:1,onChange:f=>Q(f,n)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),t(h,{label:e.$t("subtotal"),width:"170"},{default:l(({row:n})=>[_(" $"+d((n.price*n.quantity).toFixed(2)),1)]),_:1},8,["label"]),t(h,{label:e.$t("action"),align:"center",width:"80"},{default:l(({row:n})=>[t(S,{class:"btn-icon flex-end",onClick:f=>B(n.id)},{default:l(()=>[t(U,{size:18,color:"#00549a"},{default:l(()=>[t(D(E))]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])])):q("",!0),t(P,{gutter:20},{default:l(()=>[t(J,{xs:24},{default:l(()=>{var n,f;return[(n=i.value)!=null&&n.length?(g(),j(H,{key:0,modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=s=>o.value=s),class:"cart-card-mobile",onChange:a[1]||(a[1]=()=>p("selectionChange",o.value))},{default:l(()=>[(g(!0),k(G,null,K(i.value,s=>(g(),k("div",{class:"cart-card",key:s.id},[c("div",oe,[t(A,{value:s.id},null,8,["value"]),c("img",{src:s.thumbnail,alt:"Product Image",class:"product-img"},null,8,se)]),c("div",ue,[t(v,{class:"product-title"},{default:l(()=>[_(d(s.title),1)]),_:2},1024),t(P,null,{default:l(()=>[t(v,{class:"font-weight-bold"},{default:l(()=>[_(d(e.$t("unitPrice")),1)]),_:1}),a[2]||(a[2]=c("div",{class:"spacer-5"},null,-1)),t(v,null,{default:l(()=>[_("$"+d(s.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(P,null,{default:l(()=>[t(v,{class:"font-weight-bold"},{default:l(()=>[_(d(e.$t("subtotal")),1)]),_:1}),a[3]||(a[3]=c("div",{class:"spacer-5"},null,-1)),t(v,null,{default:l(()=>[_("$"+d((s.price*s.quantity).toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(I,{modelValue:s.quantity,"onUpdate:modelValue":$=>s.quantity=$,min:1,onChange:$=>Q($,s)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t(S,{class:"btn-icon flex-end",onClick:$=>B(s.id)},{default:l(()=>[t(U,{size:18,color:"#00549a"},{default:l(()=>[t(D(E))]),_:1})]),_:2},1032,["onClick"])])]))),128))]),_:1},8,["modelValue"])):q("",!0),(f=i.value)!=null&&f.length?(g(),k("div",ce,[c("div",de,[t(A,{label:e.$t("all"),"model-value":w.value,indeterminate:u.value,onChange:z,class:"hidden-sm-and-up"},null,8,["label","model-value","indeterminate"])]),c("div",ie,[c("div",re,[t(v,null,{default:l(()=>[_(d(e.$t("total"))+": ",1)]),_:1}),t(v,{class:"txtDarkBlue font-weight-bold"},{default:l(()=>[_(" $"+d(x.value),1)]),_:1})]),t(S,{class:"btn btn-primary",onClick:L},{default:l(()=>[_(d(e.$t("checkout")),1)]),_:1})])])):q("",!0)]}),_:1})]),_:1})])}}}),he=Y(_e,[["__scopeId","data-v-10658c8a"]]),ve=R({__name:"CartView",setup(F){const y=T([]),m=O(),V=Z(),p=C(()=>m.cart?m.cart:{}),o=C(()=>{var u;return((u=V.user)==null?void 0:u.id)||0}),i=u=>{y.value=u},x=async({value:u,product:b})=>{await m.updateCartQuantity({id:b.id,quantity:u})},w=async u=>{y.value=y.value.filter(b=>b!==u),await m.removeProduct(u)};return ee(async()=>{await m.fetchCart(o.value)}),(u,b)=>(g(),j(he,{products:p.value,onHandleQuantityChange:x,onRemoveProduct:w,onSelectionChange:i},null,8,["products"]))}});export{ve as default};
