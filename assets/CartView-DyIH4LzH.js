import{d as U,k as N,r as P,l as B,c as y,a as d,h as V,b as t,w as a,e as u,o as g,i,t as f,s as I,x as Q,g as R,F as G,j as J,E as K,f as O,_ as W,m as X}from"./index-3CNvc0aN.js";const Y={class:"cart-wrapper"},Z={key:0,class:"table-scroll-wrapper"},ee=["src","alt"],te={class:"card-header"},le=["src"],ae={class:"card-body"},ne={key:1,class:"cart-total"},oe={class:"check-all-wrapper"},se={class:"total-wrapper"},ce={class:"flex"},de=U({__name:"AddToCartSection",props:{products:{type:Array,default:()=>[]}},emits:["handleQuantityChange","removeProduct","selectionChange"],setup(m,{emit:C}){const v=O(),k=N(),b=m,_=C,n=P([]),s=P(2),c=B(()=>n.value.length===b.products.length),T=B(()=>n.value.length>0&&!c.value),D=r=>{n.value=r.map(l=>l.id),_("selectionChange",n.value)},E=(r,l)=>{_("handleQuantityChange",{value:r,product:l})},$=r=>{_("removeProduct",r)},L=r=>{n.value=r?b.products.map(l=>l.id):[],_("selectionChange",n.value)},z=async()=>{if(n.value.length===0){K.warning("Please select at least one product to checkout.");return}await k.checkoutSelectedProducts(s.value,n.value),v.push("/confirmation")};return(r,l)=>{const p=u("el-table-column"),q=u("el-input-number"),A=u("el-icon"),x=u("el-button"),M=u("el-table"),F=u("el-checkbox"),h=u("el-text"),w=u("el-row"),j=u("el-checkbox-group"),H=u("el-col");return g(),y("div",Y,[l[8]||(l[8]=d("h2",{class:"txtDarkBlue"},"Shopping Cart",-1)),m.products.length?(g(),y("div",Z,[t(M,{class:"cart-table",data:m.products,stripe:"",onSelectionChange:D,"row-key":"id"},{default:a(()=>[t(p,{type:"selection",width:"55"}),t(p,{label:"Image",width:"120"},{default:a(({row:e})=>[d("img",{src:e.image,alt:e.title,width:"70",height:"80"},null,8,ee)]),_:1}),t(p,{prop:"title",label:"Product",width:"280"}),t(p,{prop:"price",label:"Unit price",width:"170"},{default:a(({row:e})=>[i(" $"+f(e.price.toFixed(2)),1)]),_:1}),t(p,{label:"Quantity",width:"220"},{default:a(({row:e})=>[t(q,{modelValue:e.quantity,"onUpdate:modelValue":o=>e.quantity=o,min:1,onChange:o=>r.$emit("handleQuantityChange",o,e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(p,{label:"Subtotal",width:"170"},{default:a(({row:e})=>[i(" $"+f((e.price*e.quantity).toFixed(2)),1)]),_:1}),t(p,{label:"Action",align:"center",width:"80"},{default:a(({row:e})=>[t(x,{class:"cart-btn",onClick:o=>$(e.id)},{default:a(()=>[t(A,{size:18,color:"#00549a"},{default:a(()=>[t(I(Q))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])):V("",!0),t(w,{gutter:20},{default:a(()=>[t(H,{xs:24},{default:a(()=>[m.products.length?(g(),R(j,{key:0,modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),class:"cart-card-mobile",onChange:l[1]||(l[1]=()=>_("selectionChange",n.value))},{default:a(()=>[(g(!0),y(G,null,J(m.products,e=>(g(),y("div",{class:"cart-card",key:e.id},[d("div",te,[t(F,{value:e.id},null,8,["value"]),d("img",{src:e.image,alt:"Product Image",class:"product-img"},null,8,le)]),d("div",ae,[t(h,{class:"product-title"},{default:a(()=>[i(f(e.title),1)]),_:2},1024),t(w,null,{default:a(()=>[t(h,{class:"txtBold"},{default:a(()=>l[2]||(l[2]=[i("Unit Price: ")])),_:1}),l[3]||(l[3]=d("div",{class:"spacer-5"},null,-1)),t(h,null,{default:a(()=>[i("$"+f(e.price.toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(w,null,{default:a(()=>[t(h,{class:"txtBold"},{default:a(()=>l[4]||(l[4]=[i("Subtotal: ")])),_:1}),l[5]||(l[5]=d("div",{class:"spacer-5"},null,-1)),t(h,null,{default:a(()=>[i("$"+f((e.price*e.quantity).toFixed(2)),1)]),_:2},1024)]),_:2},1024),t(q,{modelValue:e.quantity,"onUpdate:modelValue":o=>e.quantity=o,min:1,onChange:o=>E(o,e)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t(x,{class:"cart-btn",onClick:o=>$(e.id)},{default:a(()=>[t(A,{size:18,color:"#00549a"},{default:a(()=>[t(I(Q))]),_:1})]),_:2},1032,["onClick"])])]))),128))]),_:1},8,["modelValue"])):V("",!0),m.products.length?(g(),y("div",ne,[d("div",oe,[t(F,{label:"All","model-value":c.value,indeterminate:T.value,onChange:L,class:"display-xs"},null,8,["model-value","indeterminate"])]),d("div",se,[d("div",ce,[t(h,null,{default:a(()=>l[6]||(l[6]=[i("Total: ")])),_:1}),t(h,{class:"txtDarkBlue txtBold"},{default:a(()=>[i(" $"+f(m.products.filter(e=>n.value.includes(e.id)).reduce((e,o)=>e+o.price*o.quantity,0).toFixed(2)),1)]),_:1})]),t(x,{class:"btn-solid-primary",onClick:z},{default:a(()=>l[7]||(l[7]=[i(" Checkout ")])),_:1})])])):V("",!0)]),_:1})]),_:1})])}}}),ue=W(de,[["__scopeId","data-v-fdd8835e"]]),S=2,re=U({__name:"CartView",setup(m){const C=P([]),v=N(),k=B(()=>v.cartList),b=s=>{C.value=s},_=async(s,c)=>{console.log("Row",c),c&&(c.quantity=s,await v.updateCartProduct(S,c.id,s))},n=async s=>{C.value=C.value.filter(c=>c!==s),await v.removeFromCartAndSync(S,s)};return X(()=>{v.fetchCart(S)}),(s,c)=>(g(),R(ue,{products:k.value,onHandleQuantityChange:_,onRemoveProduct:n,onSelectionChange:b},null,8,["products"]))}});export{re as default};
